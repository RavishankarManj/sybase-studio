{
	"name": "DF_SAP_TO_ADLS",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"linkedService": {
						"referenceName": "LS_SAP",
						"type": "LinkedServiceReference"
					},
					"name": "SAP"
				}
			],
			"sinks": [
				{
					"linkedService": {
						"referenceName": "ls_adls_difadlsdev",
						"type": "LinkedServiceReference"
					},
					"name": "ADLS",
					"rejectedDataLinkedService": {
						"referenceName": "ls_adls_difadlsdev",
						"type": "LinkedServiceReference"
					}
				}
			],
			"transformations": [],
			"scriptLines": [
				"parameters{",
				"     Container as string,",
				"     directory as string,",
				"     filename as string,",
				"     ODPName as string",
				"}",
				"source(output(",
				"          ROCANCEL as string,",
				"          VBELN as string,",
				"          ABSTA as string,",
				"          POSNR as string,",
				"          UVALL as string,",
				"          UVFAK as string,",
				"          UVPRS as string,",
				"          UVVLK as string,",
				"          ANGDT as string,",
				"          AUART as string,",
				"          AUGRU as string,",
				"          BNDDT as string,",
				"          BUKRS as string,",
				"          FAKSK as string,",
				"          HWAER as string,",
				"          KUNNR as string,",
				"          KURST as string,",
				"          KVGR1 as string,",
				"          KVGR2 as string,",
				"          KVGR3 as string,",
				"          KVGR4 as string,",
				"          KVGR5 as string,",
				"          LIFSK as string,",
				"          STWAE as string,",
				"          VBTYP as string,",
				"          VKBUR as string,",
				"          VKGRP as string,",
				"          VKORG as string,",
				"          VTWEG as string,",
				"          ABGRU as string,",
				"          AEDAT as string,",
				"          AWAHR as string,",
				"          BRGEW as decimal(15,3),",
				"          BWAPPLNM as string,",
				"          BWVORG as string,",
				"          CHARG as string,",
				"          CMKUA as decimal(9,5),",
				"          EAN11 as string,",
				"          ERDAT as string,",
				"          ERNAM as string,",
				"          ERZET as string,",
				"          FAKSP as string,",
				"          GEWEI as string,",
				"          KBMENG as decimal(15,3),",
				"          KLMENG as decimal(15,3),",
				"          KMEIN as string,",
				"          KNUMA_AG as string,",
				"          KPEIN as decimal(5,0),",
				"          KWMENG as decimal(15,3),",
				"          KZWI1 as decimal(13,2),",
				"          KZWI2 as decimal(13,2),",
				"          KZWI3 as decimal(13,2),",
				"          KZWI4 as decimal(13,2),",
				"          KZWI5 as decimal(13,2),",
				"          KZWI6 as decimal(13,2),",
				"          LFMNG as decimal(13,3),",
				"          LGORT as string,",
				"          LSMENG as decimal(15,3),",
				"          MATKL as string,",
				"          MATNR as string,",
				"          MATWA as string,",
				"          MEINS as string,",
				"          MVGR1 as string,",
				"          MVGR2 as string,",
				"          MVGR3 as string,",
				"          MVGR4 as string,",
				"          MVGR5 as string,",
				"          MWSBP as decimal(13,2),",
				"          NETPR as decimal(11,2),",
				"          NETWR as decimal(15,2),",
				"          NTGEW as decimal(15,3),",
				"          PABLA as string,",
				"          PKUNRE as string,",
				"          PKUNRG as string,",
				"          PKUNWE as string,",
				"          PRODH as string,",
				"          PSPDNR as string,",
				"          PSTYV as string,",
				"          PVRTNR as string,",
				"          ROUTE as string,",
				"          SOBKZ as string,",
				"          SPART as string,",
				"          STADAT as string,",
				"          STCUR as decimal(9,5),",
				"          SUGRD as string,",
				"          UEBTK as string,",
				"          UEBTO as decimal(3,1),",
				"          UMVKN as decimal(5,0),",
				"          UMVKZ as decimal(5,0),",
				"          UMZIN as decimal(5,0),",
				"          UMZIZ as decimal(5,0),",
				"          UNTTO as decimal(3,1),",
				"          VDATU as string,",
				"          VGBEL as string,",
				"          VGPOS as string,",
				"          VGTYP as string,",
				"          VOLEH as string,",
				"          VOLUM as decimal(15,3),",
				"          VRKME as string,",
				"          VSTEL as string,",
				"          WAERK as string,",
				"          WAVWR as decimal(13,2),",
				"          WERKS as string,",
				"          ZIEME as string,",
				"          ZMENG as decimal(13,3),",
				"          ZWERT as decimal(13,2),",
				"          BZIRK as string,",
				"          FBUDA as string,",
				"          FKDAT as string,",
				"          INCO1 as string,",
				"          INCO2 as string,",
				"          KDGRP as string,",
				"          KTGRD as string,",
				"          KURSK as decimal(9,5),",
				"          KURSK_DAT as string,",
				"          PRSDT as string,",
				"          WAKTION as string,",
				"          WMINR as string,",
				"          WAERK_VBAK as string,",
				"          SPARA as string,",
				"          VGTYP_AK as string,",
				"          PS_POSID as string,",
				"          ANZAUPO as decimal(9,0),",
				"          PERIV as string,",
				"          MCEX_APCAMPAIGN as string,",
				"          APOPLANNED as string,",
				"          MCBW_NETPR_AVKM as decimal(11,2)",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     store: 'SapOdp',",
				"     format: 'sapObject',",
				"     staged: true,",
				"     context: 'SAPI',",
				"     objectName: ($ODPName),",
				"     readMode: 'fullLoad',",
				"     fixDecimalPrecision: true) ~> SAP",
				"SAP sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     format: 'parquet',",
				"     fileSystem: ($Container),",
				"     folderPath: ($directory),",
				"     partitionFileNames:[($filename)],",
				"     umask: 0022,",
				"     preCommands: [],",
				"     postCommands: [],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> ADLS"
			]
		}
	}
}